--Dar de alta con fecha actual al empleado José Escriche Barrera como programador perteneciente al departamento de producción. 
--Tendrá un salario base de 70000 pts/mes y no cobrará comisión. 
DESC EMP;

SELECT max(DIR)  FROM EMP; 
select * from emp;
INSERT INTO EMP (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, SALARIO, COMISION, DEPT_NO) values
(7935, 'MUJICA', 'VENDEDOR', '7935', '31/03/2025',500000,200000,3);
--
--Se quiere dar de alta un departamento de informática situado en Fuenlabrada (Madrid). 
SELECT * FROM DEPT;
SELECT max(DEPT_NO)  FROM DEPT; 
INSERT INTO DEPT (DEPT_NO, DNOMBRE, LOC) values
(60, 'INFORMATICA', 'MADRID');
--
--El departamento de ventas, por motivos peseteros, se traslada a Teruel, realizar dicha modificación. 
UPDATE DEPT 
SET LOC = 'TERUEL'
WHERE DEPT_NO = 30;
--
--En el departamento anterior (ventas), se dan de alta dos empleados: Julián Romeral y Luis Alonso. 
-- Su salario base es el menor que cobre un empleado, y cobrarán una comisión del 15% de dicho salario. 
SELECT MIN(SALARIO)  FROM EMP; 
INSERT INTO EMP (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, SALARIO, COMISION, DEPT_NO) values
(((SELECT max(EMP_NO)  FROM EMP) + 1), 'ROMERAL', 'VENDEDOR',((SELECT max(EMP_NO)  FROM EMP) + 1) ,
 '31/03/2025',(SELECT MIN(SALARIO) FROM EMP),((SELECT MIN(SALARIO) FROM EMP) * 15 /100),3);
 --
 --Modificar la comisión de los empleados de la empresa, de forma que todos tengan un incremento del 10% del salario. 
UPDATE EMP 
SET SALARIO = SALARIO + (SALARIO * 10 / 100);
--
--Incrementar un 5% el salario de los interinos de la plantilla que trabajen en el turno de noche. 
--
SELECT * FROM PLANTILLA;
UPDATE PLANTILLA 
SET SALARIO = SALARIO + (SALARIO * 5 / 100)
WHERE FUNCION = 'INTERINO' AND TURNO = 'N';
--
--Incrementar en 5000 Pts. el salario de los empleados del departamento de ventas y del presidente,
--tomando en cuenta los que se dieron de alta antes que el presidente de la empresa. 
SELECT * FROM EMP;
SELECT * FROM DEPT;
UPDATE EMP 
SET SALARIO = SALARIO + 5000
WHERE ((DEPT_NO = 30) AND (FECHA_ALT < (SELECT FECHA_ALT FROM EMP WHERE EMP_NO = 7839)) OR (EMP_NO = 7839));
--
--El empleado Sanchez ha pasado por la derecha a un compañero. Debe
--cobrar de comisión 12.000 ptas más que el empleado Arroyo y su sueldo se
--ha incrementado un 10% respecto a su compañero
--
UPDATE EMP 
SET COMISION = COMISION  + 12000,
    SALARIO = (SALARIO * 10 / 100)
WHERE APELLIDO = 'sanchez' and  (SELECT SALARIO FROM EMP WHERE APELLIDO = 'arroyo');
--
--Se tienen que desplazar cien camas del Hospital SAN CARLOS para un
--Hospital de Venezuela. Actualizar el número de camas del Hospital SAN
--CARLOS
SELECT * FROM HOSPITAL;
UPDATE HOSPITAL
SET NUM_CAMA = NUM_CAMA - 100
WHERE NOMBRE = 'san carlos';
--
--.
--Subir el salario y la comisión en 100000 pesetas y veinticinco mil pesetas
--respectivamente a los empleados que se dieron de alta en este año.
--
UPDATE EMP 
SET COMISION = (COMISION  + 25000),
    SALARIO = (SALARIO + 100000)
WHERE (SELECT SALARIO FROM EMP WHERE APELLIDO = 'arroyo');
--
--
--
--CREACION DE LA BASE DE DATOS SIN RESTRINCIONES---
--
--
--
DROP TABLE DEPT;
DROP TABLE EMP;
DROP TABLE HOSPITAL;
DROP TABLE SALA;
DROP TABLE DOCTOR;
DROP TABLE PLANTILLA;
DROP TABLE ENFERMO;
DROP TABLE OCUPACION;

CREATE TABLE DEPT
  (DEPT_NO NUMBER(9)
  ,DNOMBRE VARCHAR2(50)
  ,LOC VARCHAR2(50)
);

CREATE TABLE EMP
  (EMP_NO NUMBER(9)
  ,APELLIDO VARCHAR2(50)
  ,OFICIO VARCHAR2(50)
  ,DIR NUMBER(9)
  ,FECHA_ALT DATE
  ,SALARIO NUMBER(9)
  ,COMISION NUMBER(9)
  ,DEPT_NO NUMBER(9)
);

CREATE TABLE HOSPITAL(
  HOSPITAL_COD NUMBER(9)
  ,NOMBRE VARCHAR2(50)
  ,DIRECCION VARCHAR2(100),
  TELEFONO VARCHAR2(9),
  NUM_CAMA NUMBER(9)
);

CREATE TABLE SALA(
  HOSPITAL_COD NUMBER(9)
  ,SALA_COD NUMBER(9)
  ,NOMBRE VARCHAR2(60)
  ,NUM_CAMA NUMBER(9)
);

CREATE TABLE DOCTOR(
  HOSPITAL_COD NUMBER(9)
  ,DOCTOR_NO NUMBER(9)
  ,APELLIDO VARCHAR2(60)
  ,ESPECIALIDAD VARCHAR2(60),
  SALARIO NUMBER(9)
);

CREATE TABLE PLANTILLA(
  HOSPITAL_COD NUMBER(9)
  ,SALA_COD NUMBER(9)
  ,EMPLEADO_NO NUMBER(9)
  ,APELLIDO VARCHAR2(60)
  ,FUNCION VARCHAR2(60)
  ,TURNO VARCHAR2(1)
  ,SALARIO NUMBER(9)
);

CREATE TABLE ENFERMO(
  INSCRIPCION NUMBER(9)
  ,APELLIDO VARCHAR2(60)
  ,DIRECCION VARCHAR2(100)
  ,FECHA_NAC DATE
  ,SEXO VARCHAR2(1)
  ,NSS NUMBER(9)
);

CREATE TABLE OCUPACION(
  INSCRIPCION NUMBER(9)
  ,HOSPITAL_COD NUMBER(9)
  ,SALA_COD NUMBER(9)
  ,CAMA NUMBER(9)
);

insert into hospital values(19,'provincial','o donell 50','964-4264',502);
insert into hospital values(18,'general','Atocha s/n','595-3111',987);
insert into hospital values(22,'la paz','castellana 1000','923-5411',412);
insert into hospital values(45,'san carlos','ciudad universitaria','597-1500',845);
insert into hospital values(17,'ruber','juan bravo 49','914027100',217);
/
insert into sala values(19,3,'cuidados intensivos',21);
insert into sala values(19,6,'psiquiatria',67);
insert into sala values(18,3,'cuidados intensivos',10);
insert into sala values(18,4,'cardiologia',53);
insert into sala values(22,1,'recuperacion',10);
insert into sala values(22,6,'psiquiatria',118);
insert into sala values(22,2,'maternidad',34);
insert into sala values(45,4,'cardiologia',55);
insert into sala values(45,1,'recuperacion',17);
insert into sala values(45,2,'maternidad',24);
insert into sala values(17,2,'maternidad',19);
insert into sala values(17,6,'psiquiatria',20);
insert into sala values(17,3,'cuidados intensivos',21);
/
insert into plantilla values(19,6,3754,'diaz b.','ENFERMERO','T',226200);
insert into plantilla values(19,6,3106,'hernandez j.','ENFERMERO','T',275500);
insert into plantilla values(18,4,6357,'karplus w.','INTERINO','T',337900);
insert into plantilla values(22,6,1009,'higueras d.','ENFERMERA','T',200500);
insert into plantilla values(22,6,8422,'bocina g.','ENFERMERO','M',163800);
insert into plantilla values(22,2,9901,'nuñez c.','INTERINO','M',221000);
insert into plantilla values(22,1,6065,'rivera g.','ENFERMERA','N',162600);
insert into plantilla values(22,1,7379,'carlos r.','ENFERMERA','T',211900);
insert into plantilla values(45,4,1280,'amigo r.','INTERINO','N',221000);
insert into plantilla values(45,1,8526,'frank h.','ENFERMERO','T',252200);
insert into plantilla values(17,2,8519,'chuko c.','ENFERMERO','T',252200);
insert into plantilla values(17,6,8520,'palomo c.','INTERINO','M',219210);
insert into plantilla values(17,6,8521,'cortes v.','ENFERMERA','N',221200);

/
insert into doctor values(19,435,'Lopez A.','Cardiologia',350000);
insert into doctor values(18,585,'Miller G.','Ginecologia',250000);
insert into doctor values(18,982,'Cajal R','Cardiologia',290000);
insert into doctor values(22,453,'Galo C.','Pediatria',250000);
insert into doctor values(22,398,'Best K.','Urologia',150000);
insert into doctor values(22,386,'Cabeza D.','Psiquiatria',125000);
insert into doctor values(45,607,'Niqo P.','Pediatria',240000);
insert into doctor values(45,522,'Adams C.','Neurologia',450000);
insert into doctor values(17,521,'Nino P.','Neurologia',390000);
insert into doctor values(17,120,'Curro F.','Urologia',250000);
/
INSERT INTO ENFERMO VALUES(10995, 'Languia M.', 'Goya 20', TO_DATE('16-05-1956', 'DD-MM-YYYY'), 'M', 280862482);
INSERT INTO ENFERMO VALUES(18004, 'Serrano V.', 'Alcala 12', TO_DATE('21-05-1960', 'DD-MM-YYYY'), 'F', 284991452);
INSERT INTO ENFERMO VALUES(14024, 'Fernandez N.', 'Recoletos 5', TO_DATE('23-07-1967', 'DD-MM-YYYY'), 'F', 321790059);
INSERT INTO ENFERMO VALUES(36658, 'Domin S.', 'Mayor 71', TO_DATE('01-01-1942', 'DD-MM-YYYY'), 'M', 160657471);
INSERT INTO ENFERMO VALUES(38702, 'Neal R.', 'Orense 21', TO_DATE('18-07-1940', 'DD-MM-YYYY'), 'F', 380010217);
INSERT INTO ENFERMO VALUES(39217, 'Cervantes M.', 'Perón 38', TO_DATE('29-02-1952', 'DD-MM-YYYY'), 'M', 440294390);
INSERT INTO ENFERMO VALUES(59076, 'Miller G.', 'Lopez de Hoyos 2', TO_DATE('16-09-1945', 'DD-MM-YYYY'), 'F', 311969044);
INSERT INTO ENFERMO VALUES(63827, 'Ruiz P.', 'Esquerdo 103', TO_DATE('26-12-1980', 'DD-MM-YYYY'), 'M', 200973253);
INSERT INTO ENFERMO VALUES(64882, 'Fraser A.', 'Soto 3', TO_DATE('10-07-1980', 'DD-MM-YYYY'), 'F', 285201776);
INSERT INTO ENFERMO VALUES(74835, 'Benitez E.', 'Argentina 5', TO_DATE('05-10-1956', 'DD-MM-YYYY'), 'M', 154811767);
/
INSERT INTO OCUPACION VALUES(10995,19,6,1);
INSERT INTO OCUPACION VALUES(18004,19,3,2);
INSERT INTO OCUPACION VALUES(14024,19,6,3);
INSERT INTO OCUPACION VALUES(36658,18,4,1);
INSERT INTO OCUPACION VALUES(38702,18,4,2);
INSERT INTO OCUPACION VALUES(39217,22,1,1);
INSERT INTO OCUPACION VALUES(59076,22,6,2);
INSERT INTO OCUPACION VALUES(63827,22,6,3);
INSERT INTO OCUPACION VALUES(64882,22,2,1);
/
insert into dept values(10,'CONTABILIDAD','SEVILLA');
insert into dept values(20,'INVESTIGACIÓN','MADRID');
insert into dept values(30,'VENTAS','BARCELONA');
insert into dept values(40,'PRODUCCIÓN','GRANADA');
/
INSERT INTO emp VALUES('7839', 'rey', 'PRESIDENTE', NULL, TO_DATE('17-11-2005', 'DD-MM-YYYY'), 650000, NULL, 10);
INSERT INTO emp VALUES('7698', 'negro', 'DIRECTOR', 7839, TO_DATE('01-05-2005', 'DD-MM-YYYY'), 370500, 0, 30);
INSERT INTO emp VALUES('7566', 'jimenez', 'DIRECTOR', 7839, TO_DATE('02-04-2005', 'DD-MM-YYYY'), 386750, 0, 20);
INSERT INTO emp VALUES('7782', 'cerezo', 'DIRECTOR', 7839, TO_DATE('09-06-2005', 'DD-MM-YYYY'), 318500, 0, 10);
INSERT INTO emp VALUES('7499', 'arroyo', 'VENDEDOR', 7698, TO_DATE('20-02-2004', 'DD-MM-YYYY'), 208000, 39000, 30);
INSERT INTO emp VALUES('7521', 'sala', 'VENDEDOR', 7698, TO_DATE('22-02-2005', 'DD-MM-YYYY'), 162500, 65000, 30);
INSERT INTO emp VALUES('7654', 'martin', 'VENDEDOR', 7698, TO_DATE('29-07-2005', 'DD-MM-YYYY'), 162500, 182000, 30);
INSERT INTO emp VALUES('7844', 'tovar', 'VENDEDOR', 7698, TO_DATE('08-07-2005', 'DD-MM-YYYY'), 195000, 0, 30);
INSERT INTO emp VALUES('7900', 'jimeno', 'EMPLEADO', 7698, TO_DATE('03-12-2005', 'DD-MM-YYYY'), 123500, 0, 30);
INSERT INTO emp VALUES('7902', 'fernandez', 'ANALISTA', 7566, TO_DATE('03-12-2007', 'DD-MM-YYYY'), 390000, 0, 20);
INSERT INTO emp VALUES('7788', 'gil', 'ANALISTA', 7566, TO_DATE('09-11-2008', 'DD-MM-YYYY'), 390000, 0, 20);
INSERT INTO emp VALUES('7369', 'sanchez', 'EMPLEADO', 7902, TO_DATE('17-12-2004', 'DD-MM-YYYY'), 104000, 0, 20);
INSERT INTO emp VALUES('7876', 'alonso', 'EMPLEADO', 7788, TO_DATE('23-07-2005', 'DD-MM-YYYY'), 143000, 0, 20);
INSERT INTO emp VALUES('7934', 'muñoz', 'EMPLEADO', 7782, TO_DATE('23-01-2006', 'DD-MM-YYYY'), 169000, 0, 10);
INSERT INTO emp VALUES('7919', 'serra', 'DIRECTOR', 7839, TO_DATE('11-12-2008', 'DD-MM-YYYY'), 395000, 0, 20);
INSERT INTO emp VALUES('7907', 'campayo', 'ANALISTA', 7919, TO_DATE('04-06-2009', 'DD-MM-YYYY'), 251000, 25000, 20);
INSERT INTO emp VALUES('7917', 'nino', 'VENDEDOR', 7919, TO_DATE('06-02-2004', 'DD-MM-YYYY'), 171000, 0, 20);
INSERT INTO emp VALUES('7904', 'ford', 'EMPLEADO', 7907, TO_DATE('04-04-2004', 'DD-MM-YYYY'), 162500, 0, 20);
INSERT INTO emp VALUES('7914', 'gutierrez', 'ANALISTA', 7919, TO_DATE('20-10-2006', 'DD-MM-YYYY'), 258500, 50000, 20);
commit;

SELECT * FROM DUAL;
--
--INSERT ANSI SLQ (MENOS RAPIDO)
-- 
INSERT INTO DEPT  VALUES ((SELECT MAX(DEPT_NO) + 1 FROM DEPT), 'INTO', 'INTO');
INSERT INTO DEPT  VALUES ((SELECT MAX(DEPT_NO) + 1 FROM DEPT), 'INTO2', 'INTO2');
INSERT INTO DEPT  VALUES ((SELECT MAX(DEPT_NO) + 1 FROM DEPT), 'INTO3', 'INTO3');

--
-- INSERT ORACLE
--
INSERT ALL
       INTO DEPT VALUES ((SELECT MAX(DEPT_NO) + 1 FROM DEPT), 'ALL', 'ALL')
       INTO DEPT VALUES ((SELECT MAX(DEPT_NO) + 1 FROM DEPT), 'ALL2', 'ALL2')
       INTO DEPT VALUES ((SELECT MAX(DEPT_NO) + 1 FROM DEPT), 'ALL3', 'ALL3')
SELECT * FROM DUAL;       
--
--
--
--
--
INSERT ALL
       INTO DEPT VALUES (50, 'ORACLE', 'BERNAVEU')
       INTO DEPT VALUES (60, 'I+D', 'OVIEDO')
SELECT * FROM DUAL;       
--
SELECT * FROM DEPT;
--
ROLLBACK;
--
--
--CREAR UNA TABLA FISICA A PARTIR DE UNA CONSULTA
--CREATE..SELECT
CREATE  TABLE DEPARTAMENTOS
AS
SELECT * FROM DEPT;
--
DESC DEPARTAMENTOS;
SELECT * FROM DEPARTAMENTOS;
--
CREATE TABLE  DOCTORHOSPITAL
AS
SELECT DOCTOR.DOCTOR_NO AS IDDOCTOR,
DOCTOR.APELLIDO, HOSPITAL.NOMBRE, HOSPITAL.TELEFONO
FROM DOCTOR
INNER JOIN HOSPITAL
ON DOCTOR.HOSPITAL_COD = HOSPITAL.HOSPITAL_COD;
--
SELECT * FROM  DOCTORHOSPITAL;

--INSERTAR DATOS A PARTIR DE TABLA
--
--INSERT INTO DESTINO
--SELECT * FROM ORIGEN;
--
--
INSERT INTO DEPARTAMENTOS
SELECT * FROM DEPT; 
--
SELECT * FROM  DEPARTAMENTOS;

--VARIABLES DE SUSTITUCION   SOLICITADA COMO ENTRADA
--&VARIABLE
--PUEDE SER USADA COMO VALOR A BUSCAR EN UN SELECT O COMO PARTE DE LA COMPARARION DE UN WHERE
--
COMMIT;
--
SELECT APELLIDO, OFICIO, SALARIO, COMISION 
FROM EMP
WHERE EMP_NO = &NUMERO; 
--
SELECT APELLIDO, &&CAMPO1, SALARIO, COMISION 
FROM EMP
WHERE &CAMPO1 = &DATO; 
--
--SE NECESITA SABER LOS EMPLEADOS QUE TRABAJAN PARA negro (7698)
SELECT * FROM EMP 
WHERE DIR = 7698;
--
--PRSEIDENTE DE LA EMPRESA  REY (7839)
--QUIENES TRABAJAN PARA EL PRESIDENTE
SELECT * FROM EMP 
WHERE DIR = 7839;
--
--MOSTRAR EMPLEADOS SUBORDINADOS A PARTIR DEL DIRECTOr JIMENEZ
SELECT LEVEL, APELLIDO, DIR, OFICIO
FROM EMP
CONNECT BY EMP_NO = PRIOR DIR
START WITH APELLIDO ='jimenez' order by 1; 
--
--
--
SELECT LEVEL, APELLIDO, OFICIO
FROM EMP
CONNECT BY EMP_NO = PRIOR DIR
START WITH APELLIDO ='arroyo';  
--
--  REVISAR   NIVELES 
--
SELECT LEVEL AS NIVEL, APELLIDO, DIR, OFICIO,
SYS_CONNECT_BY_PATH (APELLIDO, '/') AS RELACION
FROM EMP
CONNECT BY PRIOR EMP_NO = DIR
START WITH APELLIDO ='jimenez' order by 1; 
--
--
--
--TODOS
SELECT * FROM PLANTILLA WHERE TURNO = 'T'
UNION
SELECT * FROM PLANTILLA WHERE FUNCION= 'ENFERMERA';
--
--LOS QUE ESTAN EN AMBAS TABLAS (REPETIDOS)
SELECT * FROM PLANTILLA WHERE TURNO = 'T'
INTERSECT
SELECT * FROM PLANTILLA WHERE FUNCION= 'ENFERMERA';
--
--LOS QUE NO ESTAN PRESENTE EN EL PRIMER SELECT
SELECT * FROM PLANTILLA WHERE TURNO = 'T'
MINUS
SELECT * FROM PLANTILLA WHERE FUNCION= 'ENFERMERA';
--
-- T A B L A S  02/04
--
--
DROP TABLE PRUEBA;
--
-- CREAR UNA TABLA
--
CREATE TABLE PRUEBA
  (IDENTIFICADOR INTEGER, 
   TEXTO10 VARCHAR2(10), 
   TEXTOCHAR CHAR(05) 
);
--
DESCRIBE PRUEBA;
--
INSERT INTO PRUEBA VALUES (1,'ABCDEFGHIJ','AEIOU');
INSERT INTO PRUEBA VALUES (1,'A','A');
INSERT INTO PRUEBA VALUES (1,'A','ABCDE');
--
SELECT * FROM PRUEBA;
--
--DROP TABLE     ELIMINA UN OBJETO (TABLA) DENTRO DE NUESTRO SERVIDOR DE ORACLE
DROP TABLE PRUEBA;
--
--AGREGAMOS UNA NUEVA COLUMNA DE TIPO TEXTO LLAMADA NUEVA
ALTER TABLE PRUEBA
ADD (NUEVA VARCHAR2(3));
--AGREGAMOS OTRA COLUMNA DE TIPO TEXTO LLAMADEA SINNULOS 
--Y NO ADMITIRA NULOS OJO SI LA TABLA TIENE DATOS NO PERMITE HACERLO
ALTER TABLE PRUEBA
ADD (SINNULOS VARCHAR2(7) NOT NULL);

--ELIMINA UNA SOLO UNA COLUMNA DE LA TABLA
ALTER TABLE PRUEBA
DROP COLUMN SINNULOS;
--
--MODIFICAR LA CARACTERISTICA DE UNA COLUMNA DE UNA TABLA
ALTER TABLE PRUEBA
MODIFY (NUEVA FLOAT);
--
--RENOMBRAR UNA TABLA
RENAME PRUEBA TO PRUEVA;
--
RENAME PRUEVA TO PRUEBA;
--
--TRUNCATE ELIMINA TODOS LOS REGISTROS DE UNA TABLA
TRUNCATE TABLE PRUEBA;
--
--COMENTARIOS SOBRE UNA TABLA
COMMENT ON TABLE PRUEBA
IS  'HOY ES JUEVES Y MAÑANA ES VIERNES ';
--
DESCRIBE PRUEBA;
--
--COMENTARIOS 
SELECT * FROM USER_TAB_COMMENTS WHERE TABLE_NAME = 'PRUEBA';
SELECT * FROM ALL_TAB_COMMENTS WHERE TABLE_NAME = 'PRUEBA';
--
SELECT * FROM USER_TABLES;
SELECT * FROM ALL_TABLES;
--
--TODOS LOS OBJETOS CREADOS POR USUARIOS
SELECT DISTINCT OBJECT_TYPE FROM USER_OBJECTS;
--
OBJETOS QUE SON PROPIEDA DE UN USUARIO (TODOS LOS OBJETOS DEL USUARIO)
SELECT * FROM CAT;
--
--
--RESTRICIONES MEDIO NIVEL
-- PRIMARY KEY   NO PUEDE HABER VALORES NULOS Y NO ADMITE REPETIDOS
-- UNIQUE        NO PUEDE HABER REPETIDOS
-- FOREIGN KEY   INTEGRIDAD DE RELACION ENTRE TABLAS
-- CHECK         VALIDACION DE ENTRADA DE DATOS 
--
--
SELECT * FROM PRUEBA;
--
ALTER TABLE PRUEBA
ADD (TEST INT);
--
ALTER TABLE PRUEBA
ADD (DEFECTO INT DEFAULT -1);
--
INSERT INTO PRUEBA(IDENTIFICADOR, TEXTO10,TEXTOCHAR) VALUES (2,'AA','AA');
--
INSERT INTO PRUEBA(IDENTIFICADOR, TEXTO10,TEXTOCHAR,DEFECTO) VALUES (2,'AA','AA',22);
--
UPDATE PRUEBA
SET IDENTIFICADOR = 3
WHERE DEFECTO = 22;
--
INSERT INTO PRUEBA(IDENTIFICADOR, TEXTO10,TEXTOCHAR,DEFECTO) VALUES (4,'AA','AA',NULL);
--
--
--INCLUIMOS UNA  RESTRICCION PRIMARY KEY EN EL CAMPO
--DEPT_NO DE DEPARTAMENTOS PARA QUE NO PUEDA ADMITIR NULOS
ALTER TABLE DEPT
ADD CONSTRAINT PK_DEPT 
PRIMARY KEY (DEPT_NO);
--
ALTER TABLE DEPT
ADD CONSTRAINT PK_DEPT 
PRIMARY KEY (DEPT_NO);

ALTER TABLE EMP
ADD CONSTRAINT PK_EMP 
PRIMARY KEY (EMP_NO);

alter table EMP
add constraint FK_EMP_DEPT
foreign key (DEPT_NO)
references DEPT(dept_no);

ALTER TABLE EMP
ADD CONSTRAINT CH_EMP_SALARIO
CHECK (SALARIO >= 0);


--
SELECT * FROM USER_CONSTRAINTS
WHERE (SUBSTR(CONSTRAINT_NAME,1,2='PK'));
--
ALTER TABLE DEPT
DROP CONSTRAINT PK_DEPT;
--
INSERT INTO DEPT VALUES (10, 'REPE', 'REPE');
--
SELECT * FROM DEPT;
--
ALTER TABLE DEPT
DROP CONSTRAINT PK_DEPT;
--
DELETE FROM DEPT
WHERE DEPT_NO = 10;
--
--
ALTER TABLE EMP
ADD CONSTRAINT POSITIVO_EMP_SALARIO
CHECK (SALARIO >= 0);
--
SELECT * FROM EMP;
--
UPDATE EMP SET SALARIO = -1 WHERE EMP_NO = 7839;
--
SELECT * FROM EMP;
--
ALTER TABLE EMP
DROP CONSTRAINT POSITIVO_EMP_SALARIO;
--
UPDATE EMP SET SALARIO = -1 WHERE EMP_NO = 7782;
--
--
SELECT * FROM ENFERMO;
-- SE CREA LA PK
ALTER TABLE ENFERMO
ADD CONSTRAINT PK_ENFERMO
PRIMARY KEY (INSCRIPCION);
-- UNIQUE PARA EL DATOS NSS,  SEGURIDAD SOCIAL
ALTER TABLE ENFERMO
ADD CONSTRAINT U_ENFERMO_NSS
UNIQUE (NSS);
--
INSERT INTO ENFERMO VALUES
(10995, 'NUEVO', 'CALLE NUEVA', '01/01/2000', 'F', '123');
--
--
INSERT INTO ENFERMO VALUES
(10999, 'NUEVO', 'CALLE NUEVA', '01/01/2000', 'F', '280862482');
--
--
INSERT INTO ENFERMO VALUES
(NULL, 'NUEVO', 'CALLE NUEVA', '01/01/2000', 'F', '123');
--
--
INSERT INTO ENFERMO VALUES
(12346, 'NUEVO', 'CALLE NUEVA', '01/01/2000', 'F', NULL);
--
SELECT * FROM ENFERMO;
--
-- SE ELIMINAN LAS RESTRICCIONES
ALTER TABLE ENFERMO
DROP CONSTRAINT PK_ENFERMO;
--
--
alter table ENFERMO
drop CONSTRAINT U_ENFERMO_NSS;


ALTER TABLE ENFERMO 
DROP CONSTRAINT U_ENFERMO_NSS;
--
--
--
alter table EMP
add constraint FK_EMP_DEPT
foreign key (DEPT_NO)
references DEPT(dept_no);


ALTER TABLE DEPT
ADD CONSTRAINT PK_DEPT
PRIMARY KEY (DEPT_NO);

INSERT INTO DEPT VALUES (10, 'CONTABLIDAD', 'ELCHE');

SELECT * FROM DEPT;
ROLLBACK;
